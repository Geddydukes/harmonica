# LJSpeech MPS-friendly config

experiment:
  name: "ljspeech_mps"
  log_dir: "./experiments/logs/ljspeech_mps"
  checkpoint_dir: "./experiments/checkpoints/ljspeech_mps"
  seed: 42

model:
  ar:
    vocab_size: 1024
    text_vocab_size: 128
    d_model: 192
    n_heads: 4
    n_layers: 6
    d_ff: 768
    dropout: 0.1
    max_seq_len: 1024
    max_text_len: 256

data:
  dataset: "ljspeech"
  data_dir: "./data/LJSpeech-1.1"
  cache_dir: "./cache/ljspeech"
  max_audio_len: 4.0
  min_audio_len: 0.5
  num_workers: 0

training:
  batch_size: 1
  grad_accum_steps: 32
  max_steps: 50000
  lr: 3.0e-5
  warmup_steps: 500
  scheduler_type: "cosine_warmup"
  min_lr_ratio: 0.2
  weight_decay: 0.01
  max_grad_norm: 1.0
  mixed_precision: true
  checkpoint_every: 5000
  eval_every: 1000
  log_every: 100
  scheduled_sampling: false
  label_smoothing: 0.05
  # Encourage broader codebook usage early to prevent collapse.
  codebook_entropy_weight: 0.03
  codebook_entropy_warmup_steps: 15000

codec:
  type: "encodec"
  bandwidth: 6.0
  sample_rate: 24000

device:
  prefer: "mps"
